<script>
    const wrappers = document.querySelectorAll('.placeholder-wrapper');
    console.log(wrappers);
    wrappers.forEach(wrapper => {
        // Parse aspect ratio expression in data-aspect-ratio attribute
        const ratioExpr = wrapper.dataset.aspectRatio;
        let aspectRatio = NaN;
        try {
            // Evaluate the aspect ratio (e.g. "1645 / 1077")
            aspectRatio = Function('"use strict";return (' + ratioExpr + ')')();
        } catch {
            aspectRatio = NaN;
        }

        if (!isNaN(aspectRatio)) {
            wrapper.style.paddingBottom = `${aspectRatio * 100}%`;
        } else {
            // fallback to 1:1 if invalid
            wrapper.style.paddingBottom = `100%`;
        }

        const img = wrapper.querySelector('.buffer-image');
        const placeholder = wrapper.querySelector('.placeholder');

        img.onload = function () {
            placeholder.style.display = 'none';
            img.style.display = 'block';
            wrapper.style.paddingBottom = '0';  // Remove padding-bottom, avoid whitespace
        };
    });
</script>
